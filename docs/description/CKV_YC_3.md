# Ensure storage bucket is encrypted.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

```markdown
# Checkov Security Check: ObjectStorageBucketEncryption (CKV_YC_3)

This security check, `ObjectStorageBucketEncryption`, ensures that your storage buckets in Yandex Cloud, identified by the resource type `yandex_storage_bucket`, have server-side encryption enabled. The specific key that is inspected in the infrastructure configuration is: `server_side_encryption_configuration/[0]/rule/[0]/apply_server_side_encryption_by_default/[0]/kms_master_key_id`.

## The security issue

Data stored in a cloud storage bucket can include sensitive information, such as personally identifiable information (PII), financial records, or proprietary company data. If server-side encryption is not enabled, this data is stored in plaintext and is at risk of being exposed if the storage bucket is compromised. 

## Why this issue matters

Encryption at rest protects your data by converting it into an unreadable format when it's not actively being accessed or processed. Server-side encryption is a type of encryption at rest. It encrypts your data as it writes it to disk in the storage network and decrypts it for you when you access it. This means that even if an unauthorized party were to gain access to your storage bucket, they would not be able to understand the data without the encryption keys.

## How to fix the issue

To fix this issue, you should ensure that server-side encryption is enabled for all `yandex_storage_bucket` resources. This can be done by specifying a Key Management Service (KMS) key in the `server_side_encryption_configuration` block of your bucket configuration. The KMS key is used to encrypt and decrypt the data in your bucket.

Here is an example of how to enable server-side encryption for a bucket:

```hcl
resource "yandex_storage_bucket" "bucket" {
  bucket        = "bucket-name"
  acl           = "public-read"
  force_destroy = true

  server_side_encryption_configuration {
    rule {
      apply_server_side_encryption_by_default {
        kms_master_key_id = "your-kms-key-id"
      }
    }
  }
}
```

Remember, the `kms_master_key_id` can be any value, meaning you can use your own KMS key, or a default one provided by Yandex Cloud.
```

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
