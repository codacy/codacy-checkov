# Ensure run commands are not vulnerable to shell injection

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Checkov Security Check: CKV_CIRCLECIPIPELINES_6

## Issue This Check Identifies

This Checkov security check, `CKV_CIRCLECIPIPELINES_6`, is designed to identify if run commands in a CircleCI pipeline are vulnerable to shell injection. Shell injection is a type of attack where an attacker can execute arbitrary commands on the host operating system using a vulnerable application.

The check looks at the `run` commands in the CircleCI pipeline configuration and checks whether any of the commands contain known dangerous inputs that could lead to shell injection. 

## Why This Issue Matters

Shell injection vulnerabilities are extremely dangerous from a security perspective. They allow an attacker to execute arbitrary commands on the system where the vulnerable application is running, potentially leading to unauthorized access, data theft, or even a complete system compromise.

In the context of a CircleCI pipeline, a shell injection vulnerability could allow an attacker to interfere with the build process, modify the produced artifacts, steal sensitive information (like API keys or credentials), or perform other malicious actions.

## How To Fix The Issue

To fix this issue, avoid using user-supplied input directly in `run` commands without proper sanitization and validation. 

If your CircleCI pipeline requires dynamic command execution, consider these preventive measures:

- Use command placeholders or parameterized commands, which can prevent shell injection by ensuring that user-supplied input is always treated as data rather than command code.
- If possible, limit the commands that can be executed to a safe subset that provides the necessary functionality but does not allow arbitrary command execution.
- Use a library or function that can safely encode or escape user-supplied input before using it in a command.

The goal is to ensure that no part of the `run` command can be controlled by an attacker.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
