# Ensure security group is assigned to database cluster.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

## Checkov Security Check: CKV_YC_10

### What This Check Does

The Checkov security check `CKV_YC_10` verifies that the etcd database for your Yandex Kubernetes cluster (`yandex_kubernetes_cluster`) is encrypted using a KMS (Key Management Service) key. Specifically, it inspects the `kms_provider` setting in your configuration, checking whether the `key_id` attribute has a value (i.e., a KMS key is specified for encryption).

### Why This Check Matters

Etcd is a critical component of Kubernetes clusters as it stores all configuration data and state for the cluster. If an attacker were to gain access to this data, they could potentially manipulate the state of the entire Kubernetes cluster, leading to a wide array of security incidents. 

Encrypting the etcd database with a KMS key is a security best practice because it helps protect this sensitive data at rest. If an attacker manages to export this data, they will not be able to read it without the decryption key.

### How to Fix the Issue

To address this security check, you should ensure that your Yandex Kubernetes cluster's etcd database is encrypted with a KMS key. 

In your Yandex Kubernetes cluster resource configuration, you need to provide a `kms_provider` block which includes a valid `key_id`. This `key_id` should correspond to an existing KMS key in your Yandex cloud environment.

Here is an example of how to set this up in your Terraform configuration:

```hcl
resource "yandex_kubernetes_cluster" "my_cluster" {
  ...
  kms_provider {
    key_id = "your-kms-key-id"
  }
  ...
}
```

Replace `"your-kms-key-id"` with the ID of your KMS key. If you don't have a KMS key yet, you can create one in the Yandex.Cloud management console or via Yandex.Cloud API. 

Please note that you will need to have the necessary permissions to create and manage KMS keys in Yandex.Cloud. Make sure to secure your KMS keys appropriately, as anyone with access to these keys could potentially decrypt your etcd data.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
