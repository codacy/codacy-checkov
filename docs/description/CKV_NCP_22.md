# Ensure NKS control plane logging enabled for all log types

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

## Checkov Security Check: NKS Control Plane Logging (CKV_NCP_22)

### What this check does 

This Checkov security check, named "Ensure NKS control plane logging is enabled for all log types" (id: CKV_NCP_22), is designed to identify whether or not the logging for the control plane in NKS (NetApp Kubernetes Service) clusters is enabled for all log types. 

The check is specifically inspecting the key 'log/0/audit/0' within the 'ncloud_nks_cluster' resource in your Terraform configurations. 

### Why this check is important 

From a security perspective, logs are an essential tool for monitoring and auditing purposes. They provide visibility into the activity within your systems, allowing you to detect unusual behavior or potential security incidents. 

In the context of a Kubernetes cluster, control plane logs can provide crucial information about the scheduler, the API server, and other core components. If these logs are not fully enabled, it can create blind spots in your security monitoring. This can make it harder to detect attacks, diagnose system issues, or investigate incidents after they occur.

### How to fix this issue

To resolve this issue, you need to ensure that all log types for the NKS control plane are enabled. This should be specified in your Terraform configuration for the 'ncloud_nks_cluster' resource.

In the specific context of this check, you need to ensure that the 'log/0/audit/0' key is set to 'true' or 'enabled'.

Here is an example of correct configuration:

```hcl
resource "ncloud_nks_cluster" "example" {
  ...
  log {
    audit {
      enabled = true
    }
  }
  ...
}
```

Please refer to the NKS documentation for more detailed instructions on how to enable logging for other log types.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
