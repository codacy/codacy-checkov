# Ensure KMS symmetric key is rotated.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Checkov Security Check: CKV_YC_9 - KMSSymmetricKeyRotation

## What this check does

This Checkov security check, identified as `CKV_YC_9`, is designed to ensure that the Key Management Service (KMS) symmetric key is being rotated regularly. It checks the `rotation_period` of the `yandex_kms_symmetric_key` resource in your Terraform configuration. 

## Why this matters

Key rotation is a crucial part of key management and cryptographic best practices. It involves retiring an encryption key and replacing it with a new one. This process can greatly decrease the risk of a successful security attack by reducing the amount of time that a key is available for use by malicious actors. 

If an encryption key is compromised and not rotated, attackers could potentially decrypt sensitive information, leading to data breaches, loss of intellectual property, and severe reputational damage.

## How to fix the issue

To fix this issue, you should ensure that the `rotation_period` attribute of your `yandex_kms_symmetric_key` resource is defined and set to a value that aligns with your organization's key rotation policy. 

The `rotation_period` attribute specifies the frequency (in days) at which the key is automatically rotated. The value can be any integer between 7 and 730. If no rotation period is specified, the key will not be automatically rotated.

Here is an example of how you can configure key rotation:

```hcl
resource "yandex_kms_symmetric_key" "key" {
  name            = "my-key"
  description     = "description for key"
  default_algorithm = "AES_256"
  rotation_period = 30
}
```

In this example, the symmetric key `my-key` is automatically rotated every 30 days. The key algorithm used is `AES_256`.

Remember, the frequency of key rotation may vary based on the sensitivity of the data being protected and the nature of your business. A shorter rotation period can provide a higher level of security, but may also increase operational complexity.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
