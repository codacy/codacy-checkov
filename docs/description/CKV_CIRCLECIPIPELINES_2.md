# Ensure the pipeline image version is referenced via hash not arbitrary tag.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Explanation

## Check: CKV_CIRCLECIPIPELINES_2

This security check, identified as `CKV_CIRCLECIPIPELINES_2`, checks for a particular misconfiguration in the CircleCI pipeline configuration related to image versioning. Specifically, it verifies that the pipeline image is referenced via a hash and not an arbitrary tag.

## Security Issue

In software development, especially in containerized environments, it's common practice to refer to specific versions of an image using tags. However, this could lead to potential security risks if an arbitrary tag is used instead of a specific hash. The reason is that tags are mutable and can point to different images at different points in time, while hashes are immutable references to a specific image. 

If a malicious actor gains control over the image repository, they can replace the image associated with a tag, leading to a situation where your pipelines are pulling and running potentially harmful images. 

## Importance from a Security Perspective

Using a hash to reference an image ensures that you're always pulling the exact same image, providing a guarantee of immutability and traceability. It contributes to the overall integrity of your software supply chain, ensuring that your pipelines are only using authorized and verified images. 

This is a crucial aspect of security, particularly in the context of Continuous Integration/Continuous Delivery (CI/CD) pipelines, where you need to ensure that only approved and secure code is deployed to production.

## How to Fix the Issue

To fix this issue, you should always use a specific hash when referencing images in your CircleCI pipeline configuration. Instead of using tags like `latest` or any other arbitrary tag, use the unique hash provided for each image. This ensures that you are always pulling the exact same image, improving the security and reliability of your pipelines.

Here's an example:

Bad practice: `my_image:latest`

Good practice: `my_image@sha256:a1b2c3d4e5f6g7h8...` 

This way, your pipeline will always use the exact version of the image you have specified, regardless of any changes in the image repository.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
