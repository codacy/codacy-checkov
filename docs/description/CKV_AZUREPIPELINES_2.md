# Ensure container job uses a version digest

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Checkov Security Check: ContainerDigest (CKV_AZUREPIPELINES_2)

## What does this check do?

This Checkov security check, named `ContainerDigest`, ensures that each container job in Azure Pipelines specifies a version digest.

A version digest is a unique identifier for a specific version of a container image. In the provided source code, the check scans the configuration (`conf`) for the "container" key. If it finds this key and its value is a string, it checks whether the string includes a "@" character. The "@" character is used in the naming convention for container image versions (e.g., `myimage@sha256:abcd1234`). If the "@" character is found, the check passes; if not, it fails. If the "container" key is not found or its value is not a string, the check result is unknown.

## Why is this important for security?

Using a version digest is important for supply chain security. Without a version digest, a pipeline might pull the "latest" version of a container image each time it runs. If an attacker gains control of the source of the container image and modifies it, your pipeline could unknowingly pull and run a compromised image.

By specifying a version digest, you ensure that your pipeline always uses the exact same container image. This prevents an attacker from substitifying a different image, mitigating the risk of a supply chain attack.

## How to fix the issue

To fix this issue, ensure every container job in your Azure Pipelines configuration specifies a version digest. For example, instead of specifying the image as `myimage:latest`, specify it with a digest, like `myimage@sha256:abcd1234`.

You can typically find the digest for a container image in the output from the command used to build or push the image, or by using a command like `docker images --digests`.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
