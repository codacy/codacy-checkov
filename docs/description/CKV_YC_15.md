# Ensure security group is assigned to Kubernetes node group.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Checkov Security Check: CKV_YC_15

## What issue does this check identify?
The Checkov security check `CKV_YC_15` is designed to identify and flag any Kubernetes node groups that are not assigned a security group. Specifically, it verifies that a `yandex_kubernetes_node_group` resource has a `security_group_ids` property set in its `network_interface` block.

## Why this issue matters from a security perspective
Assigning a security group to a Kubernetes node group is crucial for network security. Without a security group, the node group is not subject to any inbound or outbound traffic rules. This means that by default, all inbound and outbound traffic is allowed, which can generate potential attack vectors. 

Moreover, if the node group is publicly accessible, it will be exposed to the internet, which could lead to unauthorized access to your application or data. Even if the node group is private, it can still be accessed from other resources in the same network that may have been compromised.

## How to fix the issue
To fix this issue, you should assign a security group to the Kubernetes node group. This can be done in the `network_interface` block of the `yandex_kubernetes_node_group` resource.

Here's an example:

```hcl
resource "yandex_kubernetes_node_group" "example" {
  ...
  instance_template {
    ...
    network_interface {
      ...
      security_group_ids = [yandex_vpc_security_group.example.id]
      ...
    }
  }
  ...
}
```

In this case, `yandex_vpc_security_group.example.id` is the ID of the security group that you want to assign to the node group. Replace it with your actual security group ID.

After setting the `security_group_ids` property, run Checkov again to ensure that the configuration is now secure.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
