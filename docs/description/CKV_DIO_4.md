# Ensure the firewall ingress is not wide open

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Explanation

The Checkov check `CKV_DIO_4` named "Ensure the firewall ingress is not wide open" is a security control that identifies if your firewall configuration is overly permissive. This check is targeted for Digital Ocean firewalls as indicated by the `supported_resources` variable.

## Security Issue

This check specifically identifies whether any ingress (incoming) firewall rules are set to allow traffic from all IP addresses. This is indicated by the source address being set to `0.0.0.0/0` for IPv4 or `::/0` for IPv6. These CIDR notations mean that traffic can come from any IP address in the internet, effectively leaving the firewall open to the world.

## Why it Matters

From a security perspective, this configuration is risky as it exposes your resources to potential unauthorized access, malicious attacks, and data breaches. It's a basic principle of security to limit access to the minimum necessary. By allowing traffic from all IP addresses, you are violating this principle.

## How to Fix the Issue

To fix this issue, you need to restrict the source addresses in your firewall's inbound rules. Instead of using `0.0.0.0/0` or `::/0`, specify the IP addresses or IP ranges that require access to your resources. 

For example, if you have a web server and only want to allow HTTP(S) traffic from the IP address `203.0.113.0`, your revised firewall rule might look like this:

```
inbound_rule {
    protocol         = "tcp"
    port_range       = "80-443"
    source_addresses = ["203.0.113.0"]
}
```

Remember to apply similar restrictions to all your firewall rules to ensure your resources are protected.

After making these changes, re-run the Checkov scan to confirm that your configuration now passes this security check.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
