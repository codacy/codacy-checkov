# Ensure network policy is assigned to Kubernetes cluster.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Checkov Security Check: CKV_YC_16 - Kubernetes Network Policy Assignment

## What does this check do?

This security check, identified by the ID `CKV_YC_16`, validates that a network policy is assigned to a Kubernetes cluster within a Yandex.Cloud environment. Specifically, it inspects the `network_policy_provider` attribute of the `yandex_kubernetes_cluster` resource.

A Kubernetes network policy is a specification of how groups of pods are allowed to communicate with each other and other network endpoints. Without a network policy, pods within a cluster can freely communicate, which can be a security risk. 

## Why is this important?

This check is crucial for ensuring that the principle of least privilege is applied at the network level in a Kubernetes cluster. Without a network policy, all pods in a cluster can communicate with each other unrestricted, potentially leading to unintended access or data leakage. 

A malicious actor who gains control of a single pod could potentially access sensitive information from other pods, expand their control within the cluster, or initiate attacks against other systems from the compromised cluster.

## How to fix the issue

To resolve this issue, you should assign a network policy to your Kubernetes cluster. In the `yandex_kubernetes_cluster` resource, set the `network_policy_provider` attribute to specify a network policy. 

Here is an example:

```terraform
resource "yandex_kubernetes_cluster" "example" {
  ...
  network_policy_provider {
    ...
  }
  ...
}
```

Within the `network_policy_provider` block, you can specify the details of your network policy, such as what traffic is allowed and which pods or namespaces are impacted.

Remember to tailor your network policies to the specific needs of your pods and services, ensuring that they can communicate as necessary for your applications but not beyond those requirements. This reduces the potential attack surface within your cluster and improves your overall security posture.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
