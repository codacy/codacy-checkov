# Found artifact build without evidence of cosign sbom attestation in pipeline

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Checkov Security Check: CKV_GHA_6

## What does this check do?

The Checkov security check `CKV_GHA_6` looks for GitHub Actions workflows that build an artifact, but do not provide evidence of a Software Bill of Materials (SBOM) attestation using `cosign`.

`cosign` is a tool for signing and verifying container images, which can also generate and sign SBOMs. An SBOM is a nested inventory, a list of ingredients that make up software applications. It provides transparency in the software supply chain and aids in vulnerability management, license compliance, and code quality.

## Why is this important?

Without an SBOM, it's difficult to understand what's inside the software, which can lead to potential security risks. For example, the software could include outdated or vulnerable components that could be exploited by attackers.

By signing the SBOM with `cosign`, you provide evidence that the SBOM hasn't been tampered with since it was signed. This can prevent unauthorized modifications to the SBOM, such as removing a component from the list or changing the version of a component to hide a vulnerability.

## How to fix this issue?

If the check fails, it means that your GitHub Actions workflow builds an artifact, but it doesn't use `cosign` to generate and sign an SBOM.

To fix this issue, you need to modify your workflow to generate an SBOM for the artifact and sign it with `cosign`.

Here is an example of how you can do this:

```yaml
- name: Build and push Docker image
  uses: docker/build-push-action@v2
  with:
    context: .
    push: true
    tags: user/image:tag

- name: Generate and sign SBOM
  run: |
    cosign generate sbom --sbom-disk .
    cosign sign -kms gcpkms:///projects/.../locations/global/keyRings/.../cryptoKeys/... .
```

In this example, the `cosign generate sbom` command generates an SBOM for the current directory (which should contain the source code of your artifact), and the `cosign sign` command signs it. You may need to adjust these commands based on your specific requirements and environment.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
