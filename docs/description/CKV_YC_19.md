# Ensure security group does not contain allow-all rules.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Checkov Security Check: CKV_YC_19

## Security Issue Identified
This Checkov security check, `CKV_YC_19`, identifies whether a Yandex Cloud Virtual Private Cloud (VPC) security group contains allow-all rules. These rules would permit all traffic from any IP address and any port to access resources within the VPC.

## Importance from a Security Perspective
From a security perspective, having an allow-all rule is a major risk. It essentially opens up your entire VPC to the internet, making it vulnerable to attacks. Cyber attackers could potentially exploit security vulnerabilities, perform a denial of service (DoS) attack, or execute unauthorized operations on your VPC resources. By identifying such rules, this check helps ensure that the principle of least privilege is enforced, where only necessary permissions are granted and potential attack vectors are minimized.

## How to Fix the Issue
The issue can be fixed by reviewing the configuration of the security group and removing any rules that allow unrestricted ingress access. This involves:

1. Removing any ingress rules with the CIDR block set to `0.0.0.0/0`, which represents all IPv4 addresses.
2. Ensuring that the `port` attribute is not set to `-1`, indicating all ports.
3. Checking that the `from_port` and `to_port` attributes are not set to `0` and `65535` respectively, which would allow all ports.

Instead, configure the security group to only allow traffic from trusted IP addresses and specific ports that are required for your application. This limits the potential attack surface and reduces the risk of unauthorized access.

Remember, each application and environment might require different security configurations, so always tailor your security groups to the specific needs of your resources.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
