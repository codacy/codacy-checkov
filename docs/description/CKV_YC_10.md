# Ensure etcd database is encrypted with KMS key.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

## Checkov Security Check: K8SEtcdKMSEncryption

### Description

This security check, titled "Ensure etcd database is encrypted with KMS key", is looking for a specific security configuration in a Yandex Kubernetes Cluster on Terraform. The unique identifier for this check is "CKV_YC_10".

The specific security issue or misconfiguration that this check identifies is when the etcd database of a Kubernetes cluster is not encrypted with a Key Management Service (KMS) key. The etcd database is a critical component of a Kubernetes cluster as it stores all cluster data. Therefore, it's important that this data is encrypted to protect it from unauthorized access.

### Why It Matters

From a security perspective, this issue is very important. If the etcd database is not encrypted, it could potentially expose sensitive data. This could include data about the Kubernetes cluster's state and configuration, as well as any data stored within the cluster's workloads.

Encrypting the etcd database with a KMS key provides an additional layer of security. It ensures that even if someone were to gain access to the data, they would not be able to read it without also having access to the KMS key. This helps to protect against both internal and external threats.

### How to Fix the Issue

To fix this issue, you need to ensure that the "kms_provider" field of your Yandex Kubernetes Cluster resource in Terraform is set, and that the "key_id" subfield is populated with the ID of a valid KMS key.

Here is an example of how to correctly configure this in your Terraform code:

```
resource "yandex_kubernetes_cluster" "example" {
  ...
  kms_provider {
    key_id = "your_kms_key_id"
  }
  ...
}
```

Replace "your_kms_key_id" with the ID of your KMS key. This will ensure that your etcd database is encrypted with your KMS key, passing the Checkov security check.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
