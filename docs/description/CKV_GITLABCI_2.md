# Avoid creating rules that generate double pipelines

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

## Checkov Security Check: CKV_GITLABCI_2 (AvoidDoublePipelines)

### Security Issue/Misconfiguration:
This Checkov security check, CKV_GITLABCI_2, identifies the creation of rules that generate double pipelines in GitLab CI/CD configurations. The specific security issue or misconfiguration this check identifies is when more than one pipeline is triggered for merge request events or push events.

### Importance from a Security Perspective:
From a security perspective, running multiple pipelines for the same event can lead to unnecessary resource consumption, which can cause performance issues. This could slow down the CI/CD process, delay deployments, and potentially allow for security vulnerabilities to be exploited during the extra time taken. 

Moreover, it can also lead to confusion in interpreting the results of the pipelines, as one event would have multiple corresponding results. This could potentially lead to overlooked failures or errors, missed opportunities for debugging, and generally less reliable build processes.

### How to Fix the Issue:
The issue can be fixed by adjusting the GitLab CI/CD configuration to ensure that only one pipeline is triggered for each event. This involves reviewing the 'rules' section of the configuration, specifically the 'if' conditions. 

If the 'if' condition for triggering the pipeline is set to start when the pipeline source is a merge request event or a push event (`$CI_PIPELINE_SOURCE == "merge_request_event"` or `$CI_PIPELINE_SOURCE == "push"`), make sure this condition is not duplicated in the rules. 

If multiple pipelines are necessary for different tasks, consider separating them into different stages or jobs within the same pipeline, or use different conditions for triggering them. This way, the pipelines can be better managed and monitored, and resources can be used more efficiently.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
