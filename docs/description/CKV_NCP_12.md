# An inbound Network ACL rule should not allow ALL ports.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Checkov Security Check: NACLPortCheck (CKV_NCP_12)

## What the Check Does

This security check, identified by the ID `CKV_NCP_12`, scrutinizes the configuration of inbound Network Access Control List (NACL) rules to ensure that they do not permit traffic from all ports. The specific security misconfiguration it identifies is the opening of all ports (i.e., the port range 1-65535) in the inbound NACL rules.

## Why This Matters

From a security perspective, this matter is critical because opening all ports in an inbound NACL can create a significant vulnerability. It essentially leaves the network wide open to potential malicious traffic, including hacking attempts, Distributed Denial of Service (DDoS) attacks, and other forms of cyber-attacks. 

By allowing traffic from all ports, the network becomes an easy target for attackers who can exploit the open ports to gain unauthorized access to the system, steal sensitive data, or disrupt services. Therefore, it's crucial to restrict the inbound NACL rules to only allow traffic from necessary and secure ports.

## How to Fix the Issue

To fix this issue, you should explicitly define the ports or port ranges necessary for the operation of your application in the inbound NACL rules. Avoid using the port range "1-65535", which opens all ports. 

Instead, specify only those ports that are absolutely necessary for your application's functionality. For example, if your application only needs to receive HTTP and HTTPS traffic, your inbound rules should only allow traffic from ports 80 (HTTP) and 443 (HTTPS). 

Remember, the principle of least privilege should be applied when configuring your NACLs. Only the minimum necessary ports should be open to reduce the potential attack surface.

```python
inbound = {
    'port_range': '80,443'
}
```

By properly configuring your NACLs, you can significantly improve your network's security posture and reduce the risk of cyber-attacks.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
