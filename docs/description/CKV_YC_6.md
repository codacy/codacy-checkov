# Ensure Kubernetes cluster node group does not have public IP addresses.

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

# Checkov Security Check: CKV_YC_6

## What this Check Does
This Checkov security check, identified as `CKV_YC_6`, is designed to ensure that Kubernetes cluster node groups do not have public IP addresses. The specific resource it supports is the `yandex_kubernetes_node_group`.

The check inspects the `instance_template/[0]/network_interface/[0]/nat` key. If the value of this key is set to `True`, it means that network interfaces of instances in the Kubernetes node group are configured with a public IP address via NAT (Network Address Translation), which is flagged as a forbidden value by the check.

## Why this Check Matters
From a security perspective, exposing the Kubernetes node groups to the public internet can make them vulnerable to attacks. By assigning public IP addresses to these nodes, they become directly reachable from the internet, increasing the surface area for potential security threats. 

An attacker could exploit vulnerabilities in these nodes, leading to unauthorized access, data breaches, or denial-of-service attacks. Therefore, it is critical to minimize the exposure of your Kubernetes nodes to the public internet.

## How to Fix the Issue
To fix this issue, you need to ensure that the `nat` key under `instance_template/[0]/network_interface/[0]/` is set to `False` for your `yandex_kubernetes_node_group` resource. This way, the nodes in the Kubernetes cluster group will not be assigned public IP addresses, thus reducing the potential attack surface.

Here's an example of how to configure this:

```terraform
resource "yandex_kubernetes_node_group" "default" {
  ...

  instance_template {
    ...
    network_interface {
      nat = false
      ...
    }
  }
}
```

This configuration ensures that the nodes are only accessible via internal network interfaces, thus improving the security posture of your Kubernetes cluster.

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
