# Ensure GitHub branch protection rules does not allow deletions

_This pattern description was written by a Codacy bot for Checkov. Send feedback to ai-patterns@codacy.com_

This Checkov security check, labeled as "CKV_GITHUB_18", is designed to identify a specific misconfiguration related to GitHub branch protection rules. Specifically, this check verifies if the 'allow_deletions' setting is enabled or not.

From a security perspective, this issue matters tremendously. If the 'allow_deletions' setting is enabled, it means that users with write access to the repository can delete the branch. This could potentially lead to loss of critical code, unintentional disruption of ongoing work, or even malicious acts such as codebase sabotage or data destruction. In a worst-case scenario, if backups or version control practices are not in place, this could lead to irreversible loss of codebase.

To fix this issue, you will need to disable the 'allow_deletions' setting in your GitHub repository's branch protection rules. You can do this by navigating to the settings of your GitHub repository, clicking on 'Branches' in the left sidebar, selecting 'Branch protection rules', and then choosing 'Edit' next to the rule you want to change. From there, you will want to ensure that the 'Allow deletions' checkbox is not checked. Save your changes to rectify this security misconfiguration.

Here's the markdown version of the explanation:

```markdown
# Security Check: CKV_GITHUB_18

This Checkov security check ensures that GitHub branch protection rules do not allow deletions.

## Security Issue

If the 'allow_deletions' setting is enabled on GitHub, users with write access can delete the branch. This can result in loss of critical code, disruption of ongoing work, or even potential sabotage or data destruction. 

## Why It Matters

Allowing branch deletions can pose a significant security risk. Codebase can be accidentally or intentionally deleted, which can lead to irreversible loss if backups or version control practices are not in place.

## How to Fix It

Disable the 'allow_deletions' setting in your GitHub repository's branch protection rules. Here's how:

1. Go to your GitHub repository settings.
2. Click on 'Branches' in the left sidebar.
3. Select 'Branch protection rules'.
4. Click 'Edit' next to the rule you want to change.
5. Ensure that the 'Allow deletions' checkbox is not checked.
6. Save your changes.
```

_(Text generated by Codacy Bot. Send feedback to ai-pattern-text@codacy.com)_
